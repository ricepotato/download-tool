{% load static %}
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <title>Linker</title>
  </head>
  <body>
    <h1>링크 관리</h1>

    <!-- 메시지 표시 -->
    {% if messages %}
    <div class="messages">
      {% for message in messages %}
      <div class="alert alert-{{ message.tags }}">{{ message }}</div>
      {% endfor %}
    </div>
    {% endif %}

    <!-- 새 링크 추가 폼 -->
    <div class="form-container">
      <h2>새 링크 추가</h2>
      <form method="post">
        {% csrf_token %} {{ form.as_p }}
        <button type="submit">링크 추가</button>
      </form>
    </div>

    <!-- 링크 목록 -->
    <div class="data-container">
      <h2>저장된 링크 목록</h2>

      {% if links %}
      <div class="links-list">
        {% for link in links %}
        <div class="link-item">
          <div class="link-content">
            <h3>
              <a
                href="{{ link.url }}"
                target="_blank"
                rel="noopener noreferrer"
              >
                {{ link.title|default:link.url }}
              </a>
            </h3>
            {% if link.summary %}
            <p class="link-summary">{{ link.summary }}</p>
            {% endif %}
            <p class="link-meta">
              <small>추가일: {{ link.created_at|date:"Y-m-d H:i" }}</small>
            </p>

            <!-- 태그 표시 -->
            <div class="link-tags">
              {% if link.tags.all %}
              <span class="tags-label">태그:</span>
              {% for tag in link.tags.all %}
              <span class="tag">{{ tag.name }}</span>
              {% endfor %} {% else %}
              <span class="no-tags">태그 없음</span>
              {% endif %}
            </div>
          </div>

          <div class="link-actions">
            <a href="{% url 'add-tags' link.id %}" class="btn btn-tags"
              >태그 관리</a
            >
          </div>
        </div>
        {% endfor %}
      </div>

      <!-- 페이지네이션 -->
      {% if is_paginated %}
      <div class="pagination">
        {% if page_obj.has_previous %}
        <a href="?page=1">&laquo; 첫 페이지</a>
        <a href="?page={{ page_obj.previous_page_number }}">이전</a>
        {% endif %}

        <span class="current">
          페이지 {{ page_obj.number }} / {{ page_obj.paginator.num_pages }}
        </span>

        {% if page_obj.has_next %}
        <a href="?page={{ page_obj.next_page_number }}">다음</a>
        <a href="?page={{ page_obj.paginator.num_pages }}"
          >마지막 페이지 &raquo;</a
        >
        {% endif %}
      </div>
      {% endif %} {% else %}
      <p class="no-links">저장된 링크가 없습니다.</p>
      {% endif %}
    </div>
  </body>
</html>
